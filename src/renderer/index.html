<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            http-equiv="Content-Security-Policy"
            content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; font-src 'self'; frame-src 'self' http://localhost:*; connect-src 'self' http://localhost:*;"
        />
        <title>HXK Terminal</title>
        <link rel="stylesheet" href="styles/main.css" />
        <link rel="stylesheet" href="styles/navigation.css" />
        <link rel="stylesheet" href="styles/task.css" />
        <link rel="stylesheet" href="styles/calendar.css" />
        <link rel="stylesheet" href="styles/settings.css" />
        <link rel="stylesheet" href="styles/files.css" />
        <link rel="stylesheet" href="styles/custom-select.css" />
        <style>
            @font-face {
                font-family: 'AlimamaShuHeiTi-Bold';
                src: url('Assets/Fonts/AlimamaShuHeiTi-Bold.ttf')
                    format('truetype');
                font-weight: bold;
                font-style: normal;
            }
        </style>
    </head>
    <body>
        <div id="app">
            <!-- 导航栏 -->
            <nav id="navigation-bar" class="navigation-bar">
                <!-- 展开状态 -->
                <div id="expanded-nav" class="expanded-nav">
                    <div class="nav-header">
                        <button
                            id="collapse-btn"
                            class="icon-btn"
                            title="收起菜单"
                        >
                            <img
                                src="Assets/Icons/left-circle.svg"
                                width="20"
                                height="20"
                                alt="收起菜单"
                            />
                        </button>

                        <div class="user-info">
                            <div class="user-avatar">
                                <img
                                    src="Assets/Icons/user.svg"
                                    width="42"
                                    height="42"
                                    alt="用户头像"
                                />
                            </div>
                            <div class="user-name" id="user-name">用户</div>
                        </div>
                    </div>

                    <div class="nav-menu">
                        <button class="nav-item" data-view="home">
                            <img
                                src="Assets/Icons/home.svg"
                                width="18"
                                height="18"
                                alt="首页"
                            />
                            <span>首页</span>
                        </button>

                        <button class="nav-item" data-view="tasks">
                            <img
                                src="Assets/Icons/task.svg"
                                width="18"
                                height="18"
                                alt="任务"
                            />
                            <span>任务</span>
                            <span class="count-badge" id="task-count">0</span>
                        </button>

                        <button class="nav-item" data-view="calendar">
                            <img
                                src="Assets/Icons/calendar.svg"
                                width="18"
                                height="18"
                                alt="日历"
                            />
                            <span>日历</span>
                        </button>

                        <button class="nav-item" data-view="files">
                            <img
                                src="Assets/Icons/folder.svg"
                                width="18"
                                height="18"
                                alt="文件"
                            />
                            <span>文件</span>
                        </button>

                        <button class="nav-item" data-view="publish">
                            <img
                                src="Assets/Icons/push.svg"
                                width="18"
                                height="18"
                                alt="发布"
                            />
                            <span>发布</span>
                        </button>
                    </div>

                    <div class="nav-footer">
                        <div class="nav-divider"></div>

                        <button class="nav-item-bottom" data-view="settings">
                            <img
                                src="Assets/Icons/setting.svg"
                                width="18"
                                height="18"
                                alt="设置"
                            />
                            <span>设置</span>
                        </button>

                        <button class="nav-item-bottom" id="logout-btn">
                            <img
                                src="Assets/Icons/logout.svg"
                                width="18"
                                height="18"
                                alt="登出"
                            />
                            <span>登出</span>
                        </button>
                    </div>
                </div>

                <!-- 折叠状态 -->
                <div id="collapsed-nav" class="collapsed-nav">
                    <button id="expand-btn" class="expand-btn" title="展开菜单">
                        <img
                            src="Assets/Icons/navbar.svg"
                            width="18"
                            height="18"
                            alt="展开菜单"
                        />
                    </button>
                </div>
            </nav>

            <!-- 主内容区域 -->
            <main id="main-content" class="main-content">
                <!-- 首页 -->
                <div id="home-view" class="view active">
                    <div class="welcome-section">
                        <h1>欢迎使用 HXK Terminal</h1>
                        <p>统一管理工作资料与任务的跨平台协作工具</p>
                    </div>
                </div>

                <!-- 任务视图 -->
                <div id="tasks-view" class="view">
                    <div class="view-header">
                        <div class="view-title">
                            <h2>任务中心</h2>
                            <p>小科提醒你该工作了！！！</p>
                        </div>
                        <button id="publish-task-btn" class="primary-btn">
                            <img
                                src="Assets/Icons/plus.svg"
                                width="18"
                                height="18"
                                alt="发布任务"
                            />
                            <span>发布任务</span>
                        </button>
                    </div>

                    <div class="task-tabs">
                        <button class="tab-btn active" data-tab="available">
                            <img
                                src="Assets/Icons/bell.svg"
                                width="18"
                                height="18"
                                alt="待接取"
                            />
                            <span>待接取</span>
                            <span class="count-badge" id="available-count"
                                >0</span
                            >
                        </button>
                        <button class="tab-btn" data-tab="my-tasks">
                            <img
                                src="Assets/Icons/flag.svg"
                                width="18"
                                height="18"
                                alt="我的任务"
                            />
                            <span>我的任务</span>
                            <span
                                class="count-badge count-badge-danger"
                                id="my-tasks-count"
                                >0</span
                            >
                        </button>
                    </div>

                    <div class="task-content">
                        <div id="available-tasks" class="task-list active">
                            <!-- 待接取任务列表 -->
                        </div>
                        <div id="my-tasks" class="task-list">
                            <!-- 我的任务列表 -->
                        </div>
                    </div>
                </div>

                <!-- 日历视图 -->
                <div id="calendar-view" class="view">
                    <div class="view-header">
                        <div class="view-title">
                            <h2>日历</h2>
                            <p>管理你的日程安排</p>
                        </div>
                        <button id="add-event-btn" class="primary-btn">
                            <img
                                src="Assets/Icons/plus.svg"
                                width="18"
                                height="18"
                                alt="添加事件"
                            />
                            <span>添加事件</span>
                        </button>
                    </div>
                    <div class="calendar-content">
                        <div id="calendar-container"></div>
                    </div>
                </div>

                <!-- 文件视图 -->
                <div id="files-view" class="view">
                    <div class="view-header">
                        <div class="view-title">
                            <h2>文件管理</h2>
                            <p>对，就是你，记得同步工作！！！</p>
                        </div>
                        <div class="file-toolbar">
                            <div class="toolbar-group">
                                <button
                                    id="refresh-alist-btn"
                                    class="toolbar-btn"
                                    title="刷新"
                                >
                                    <svg
                                        width="16"
                                        height="16"
                                        viewBox="0 0 24 24"
                                        fill="currentColor"
                                    >
                                        <path
                                            d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"
                                        />
                                    </svg>
                                </button>
                                <button
                                    id="open-alist-external-btn"
                                    class="toolbar-btn"
                                    title="在新窗口打开"
                                >
                                    <svg
                                        width="16"
                                        height="16"
                                        viewBox="0 0 24 24"
                                        fill="currentColor"
                                    >
                                        <path
                                            d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"
                                        />
                                    </svg>
                                </button>
                            </div>
                            <div class="connection-status">
                                <div id="alist-status" class="status-indicator">
                                    <div class="status-dot"></div>
                                    <span class="status-text"
                                        >检查连接中...</span
                                    >
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="files-content">
                        <div id="Alist-container" class="Alist-container">
                            <div id="alist-loading" class="loading-overlay">
                                <div class="loading-spinner"></div>
                                <p>正在加载文件管理器...</p>
                            </div>
                            <iframe
                                id="alist-iframe"
                                src="http://localhost:5244/"
                                allowfullscreen
                            ></iframe>
                            <div
                                id="alist-error"
                                class="error-overlay"
                                style="display: none"
                            >
                                <div class="error-content">
                                    <svg
                                        width="48"
                                        height="48"
                                        viewBox="0 0 24 24"
                                        fill="currentColor"
                                    >
                                        <path
                                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                                        />
                                    </svg>
                                    <h3>连接失败</h3>
                                    <p>
                                        无法连接到 Alist 服务 (localhost:5244)
                                    </p>
                                    <div class="error-actions">
                                        <button
                                            id="retry-alist-btn"
                                            class="retry-btn"
                                        >
                                            重试
                                        </button>
                                        <button
                                            id="start-alist-btn"
                                            class="start-btn"
                                        >
                                            启动 Alist
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 发布视图 -->
                <div id="publish-view" class="view">
                    <div class="view-header">
                        <h2>内容发布</h2>
                    </div>
                    <div class="publish-content">
                        <p>内容发布功能开发中...</p>
                    </div>
                </div>

                <!-- 设置视图 -->
                <div id="settings-view" class="view">
                    <div class="view-header">
                        <h2>设置</h2>
                    </div>
                    <div class="settings-content">
                        <div class="settings-section">
                            <h3>用户设置</h3>
                            <div class="setting-item">
                                <label>用户名</label>
                                <input
                                    type="text"
                                    id="username-input"
                                    placeholder="请输入用户名"
                                />
                            </div>
                            <div class="setting-item">
                                <label>主题</label>
                                <select id="theme-select">
                                    <option value="light">浅色主题</option>
                                    <option value="dark">深色主题</option>
                                    <option value="auto">跟随系统</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>
                                <img
                                    src="Assets/Icons/folder.svg"
                                    width="20"
                                    height="20"
                                    alt="数据管理"
                                />
                                数据管理
                            </h3>
                            <div class="setting-item">
                                <label for="download-path">
                                    默认下载路径
                                    <span class="setting-description"
                                        >设置文件默认下载保存位置</span
                                    >
                                </label>
                                <div class="path-input-group">
                                    <input
                                        type="text"
                                        id="download-path"
                                        placeholder="选择下载路径"
                                        readonly
                                    />
                                    <button
                                        id="select-download-path-btn"
                                        class="btn btn-secondary"
                                    >
                                        <img
                                            src="Assets/Icons/folder.svg"
                                            width="16"
                                            height="16"
                                            alt="浏览"
                                        />
                                        浏览
                                    </button>
                                </div>
                            </div>
                            <div class="setting-item">
                                <label for="cloud-drive-url">
                                    阿里云盘链接
                                    <span class="setting-description"
                                        >配置阿里云盘Web访问地址</span
                                    >
                                </label>
                                <input
                                    type="url"
                                    id="cloud-drive-url"
                                    placeholder="https://www.aliyundrive.com/..."
                                />
                            </div>
                            <div class="setting-actions">
                                <button
                                    id="save-data-settings-btn"
                                    class="btn btn-primary"
                                >
                                    <img
                                        src="Assets/Icons/save.svg"
                                        width="16"
                                        height="16"
                                        alt="保存"
                                    />
                                    保存设置
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- 发布任务模态框 -->
        <div id="publish-task-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>发布任务</h3>
                    <button class="close-btn" id="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="publish-task-form">
                        <div class="form-group">
                            <label for="task-title">任务标题</label>
                            <input type="text" id="task-title" required />
                        </div>
                        <div class="form-group">
                            <label for="task-description">任务描述</label>
                            <textarea
                                id="task-description"
                                rows="4"
                                required
                            ></textarea>
                        </div>
                        <div class="form-group">
                            <label for="task-type">任务类型</label>
                            <select id="task-type" required>
                                <option value="personal">个人任务</option>
                                <option value="team">团体任务</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="task-priority">优先级</label>
                            <select id="task-priority">
                                <option value="1">低</option>
                                <option value="2">中</option>
                                <option value="3">高</option>
                                <option value="4">紧急</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="task-deadline">截止时间</label>
                            <input type="datetime-local" id="task-deadline" />
                        </div>
                        <div class="form-group">
                            <label for="task-tags">标签（用逗号分隔）</label>
                            <input
                                type="text"
                                id="task-tags"
                                placeholder="例如：前端,紧急,设计"
                            />
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button
                        type="button"
                        class="btn btn-secondary"
                        id="cancel-publish"
                    >
                        取消
                    </button>
                    <button
                        type="submit"
                        class="btn btn-primary"
                        form="publish-task-form"
                    >
                        发布任务
                    </button>
                </div>
            </div>
        </div>

        <!-- 添加事件模态框 -->
        <div id="add-event-modal" class="modal">
            <div class="modal-content add-event-modal">
                <div class="modal-header">
                    <div class="header-content">
                        <div class="header-icon">
                            <img
                                src="Assets/Icons/plus-calendar.svg"
                                width="24"
                                height="24"
                                alt="添加事件"
                            />
                        </div>
                        <div class="header-text">
                            <h3>添加新事件</h3>
                            <p>创建你的日程安排</p>
                        </div>
                    </div>
                    <button class="close-btn" id="close-event-modal">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <form id="add-event-form">
                        <div class="form-section">
                            <div class="section-title">
                                <img
                                    src="Assets/Icons/tag.svg"
                                    width="16"
                                    height="16"
                                    alt="基本信息"
                                />
                                <span>基本信息</span>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="event-title">
                                        <img
                                            src="Assets/Icons/check.svg"
                                            width="14"
                                            height="14"
                                            alt="标题"
                                        />
                                        事件标题
                                    </label>
                                    <input
                                        type="text"
                                        id="event-title"
                                        placeholder="输入事件标题"
                                        required
                                    />
                                </div>
                                <div class="form-group">
                                    <label for="event-type">
                                        <img
                                            src="Assets/Icons/flag.svg"
                                            width="14"
                                            height="14"
                                            alt="类型"
                                        />
                                        事件类型
                                    </label>
                                    <select id="event-type" required>
                                        <option value="deadline">
                                            截止日期
                                        </option>
                                        <option value="meeting">会议</option>
                                        <option value="task">任务</option>
                                        <option value="event">其他事件</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="event-description">
                                    <img
                                        src="Assets/Icons/tag.svg"
                                        width="14"
                                        height="14"
                                        alt="描述"
                                    />
                                    事件描述
                                </label>
                                <textarea
                                    id="event-description"
                                    rows="3"
                                    placeholder="描述事件的详细信息（可选）"
                                ></textarea>
                            </div>
                        </div>

                        <div class="form-section">
                            <div class="section-title">
                                <img
                                    src="Assets/Icons/calendar.svg"
                                    width="16"
                                    height="16"
                                    alt="时间安排"
                                />
                                <span>时间安排</span>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="event-date">
                                        <img
                                            src="Assets/Icons/calendar.svg"
                                            width="14"
                                            height="14"
                                            alt="日期"
                                        />
                                        日期
                                    </label>
                                    <input
                                        type="date"
                                        id="event-date"
                                        required
                                    />
                                </div>
                                <div class="form-group">
                                    <label for="event-time">
                                        <img
                                            src="Assets/Icons/hourglass.svg"
                                            width="14"
                                            height="14"
                                            alt="时间"
                                        />
                                        时间
                                    </label>
                                    <input
                                        type="time"
                                        id="event-time"
                                        required
                                    />
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="event-duration">
                                    <img
                                        src="Assets/Icons/hourglass.svg"
                                        width="14"
                                        height="14"
                                        alt="持续时间"
                                    />
                                    持续时间
                                </label>
                                <div class="duration-input">
                                    <input
                                        type="number"
                                        id="event-duration"
                                        value="60"
                                        min="15"
                                        step="15"
                                    />
                                    <span class="duration-unit">分钟</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button
                        type="button"
                        class="btn btn-secondary"
                        id="cancel-add-event"
                    >
                        <img
                            src="Assets/Icons/close.svg"
                            width="16"
                            height="16"
                            alt="取消"
                        />
                        取消
                    </button>
                    <button
                        type="submit"
                        class="btn btn-primary"
                        form="add-event-form"
                    >
                        <img
                            src="Assets/Icons/plus.svg"
                            width="16"
                            height="16"
                            alt="添加"
                        />
                        添加事件
                    </button>
                </div>
            </div>
        </div>

        <!-- 事件详情模态框 -->
        <div id="event-detail-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="event-detail-title">事件详情</h3>
                    <button class="close-btn" id="close-event-detail-modal">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div class="event-detail-info">
                        <div class="detail-item">
                            <label>类型：</label>
                            <span id="event-detail-type"></span>
                        </div>
                        <div class="detail-item">
                            <label>日期：</label>
                            <span id="event-detail-date"></span>
                        </div>
                        <div class="detail-item">
                            <label>时间：</label>
                            <span id="event-detail-time"></span>
                        </div>
                        <div class="detail-item">
                            <label>描述：</label>
                            <span id="event-detail-description"></span>
                        </div>
                        <div
                            class="detail-item"
                            id="event-detail-attendance"
                            style="display: none"
                        >
                            <label>出席状态：</label>
                            <span id="event-detail-status"></span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div id="event-actions">
                        <!-- 动态生成的操作按钮 -->
                    </div>
                </div>
            </div>
        </div>

        <script type="module" src="js/custom-select.js"></script>
        <script type="module" src="i18n/i18n.js"></script>
        <script type="module" src="js/app.js"></script>
        <script type="module" src="js/navigation.js"></script>
        <script type="module" src="js/task.js"></script>
        <script type="module" src="js/calendar.js"></script>
        <script type="module" src="js/settings.js"></script>
        <script type="module" src="js/files.js"></script>
    </body>
</html>
